var timerArea,reminderNumTemp,reminderNote,reminderSubmit,timers=[],userTimezone="",neko={};$(function(){neko.init()}),neko.init=function(){timerArea=$("#timer-area"),reminderNumTemp=$("#temp-reminder-number"),reminderNote=$("#reminder-note"),reminderSubmit=$("#reminder-submit"),reminderSubmit.on("click",neko.submit),"default"===Notification.permission&&Notification.requestPermission(),neko.ticker=new interval(neko.tick,100),neko.ticker.start(),window.addEventListener("blur",function(){$("#reminder-onblur-setting").prop("checked")&&(neko.ticker.end(),neko.ticker.time=5e3,neko.ticker.start())}),window.addEventListener("focus",function(){100!=neko.ticker.time&&(neko.ticker.end(),neko.ticker.time=100,neko.ticker.start())})},neko.submit=function(){let a,b={},c=Date.now(),d=reminderNumTemp[0].valueAsNumber,e=new Date(c+1e3*d);isNaN(d)||(b.target=c+1e3*d,b.note=reminderNote.val().replace("<","&lt;").replace(">","&gt;")||"Untitled Timer",b.lastTick=c,b.startedAt=c,b.id=c.toString(16),b.status="running",a=$("<div>",{id:b.id,class:"timer"}),a.append($("<button>").html("X").on("click",function(){$("#"+b.id).remove();let a=timers.findIndex(function(a){return a.id===b.id}.bind(b));timers[a].status="deleted"}.bind(b))),a.append($("<h2>").html(b.note)),a.append($("<progress>",{value:"0",max:"100"})),a.append($("<span>",{class:"small"}).html("Ends at "+e.toLocaleTimeString())),timerArea.append(a),timers.push(b))},neko.tick=function(){if(!(1>timers.length))for(timer of timers){if("running"!=timer.status)continue;let a=Date.now(),b=a-timer.lastTick,c=0|100*((a-timer.startedAt)/(timer.target-timer.startedAt));timer.lastTick=a,100<c&&(c=100),a>=timer.target&&(timer.status="finished",new Notification("Your Timer "+timer.note+" ended!")),$("#"+timer.id).find("progress").prop("value",c)}};